BEGIN TRANSACTION;

-- create a table
DROP TABLE IF EXISTS Salary;
CREATE TABLE Salary
(DepNo int NOT NULL,
Name char NOT NULL,
Salary float NOT NULL);

-- create second table
DROP TABLE IF EXISTS DEP;
CREATE TABLE DEP
(DepNo int NOT NULL,
Name char NOT NULL);

-- insert Salary values
INSERT INTO Salary VALUES (1, 'Jonas', 700);
INSERT INTO Salary VALUES (1, 'Petras', 800);
INSERT INTO Salary VALUES (1, 'Juozas', 650);
INSERT INTO Salary VALUES (2, 'Onutė', 900);
INSERT INTO Salary VALUES (2, 'Marytė', 700);
INSERT INTO Salary VALUES (3, 'Tadas', 750);

-- insert DEP values
INSERT INTO DEP VALUES (1, 'Vilnius');
INSERT INTO DEP VALUES (2, 'Kauno');
INSERT INTO DEP VALUES (3, 'Klaipėdos');
INSERT INTO DEP VALUES (4, 'Šiaulių');

-- a)
select *from Salary 
group by salary 
order by salary desc limit 1,1;

--b)
SELECT
    Depno,
    ROUND(AVG(Salary),2)
FROM
    Salary
GROUP BY
    DepNo;

--c)
SELECT Salary FROM Salary Where Name LIKE 'J%'